<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UberChat - Mensajería Global</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
</head>
<body>
    <!-- Pantalla de Introducción -->
    <div id="intro-screen" class="screen active">
        <div class="intro-container">
            <div class="logo">
                <i class="fas fa-comments"></i>
                <h1>UberChat</h1>
            </div>
            <p class="intro-text">Conecta con el mundo sin barreras de idioma</p>
            <div class="language-selector">
                <label>Selecciona tu idioma:</label>
                <select id="language-select">
                    <option value="es">Español</option>
                    <option value="en">English</option>
                    <option value="fr">Français</option>
                    <option value="de">Deutsch</option>
                    <option value="pt">Português</option>
                    <option value="it">Italiano</option>
                </select>
            </div>
            <button class="primary-btn" onclick="goToRegister()">
                <span>Comenzar</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- Pantalla de Registro -->
    <div id="register-screen" class="screen">
        <div class="register-container">
            <button class="back-btn" onclick="goToIntro()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="register-header">
                <h2>Tu número de teléfono</h2>
                <p>Te enviaremos un código de verificación</p>
            </div>
            <div class="phone-input-container">
                <div class="country-selector">
                    <select id="country-select">
                        <option value="+34">España (+34)</option>
                        <option value="+1">Estados Unidos (+1)</option>
                        <option value="+52">México (+52)</option>
                        <option value="+54">Argentina (+54)</option>
                        <option value="+55">Brasil (+55)</option>
                        <option value="+33">Francia (+33)</option>
                        <option value="+49">Alemania (+49)</option>
                    </select>
                </div>
                <input type="tel" id="phone-input" placeholder="Número de teléfono" maxlength="15">
            </div>
            <div id="recaptcha-container"></div>
            <button class="primary-btn" onclick="sendVerificationCode()" id="send-code-btn" disabled>
                <span>Enviar código</span>
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Pantalla de Verificación -->
    <div id="verification-screen" class="screen">
        <div class="verification-container">
            <button class="back-btn" onclick="goToRegister()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="verification-header">
                <h2>Verificación</h2>
                <p>Ingresa el código de 6 dígitos que enviamos a <span id="phone-display"></span></p>
            </div>
            <div class="code-input-container">
                <input type="text" maxlength="1" class="code-digit" oninput="handleCodeInput(this, 0)">
                <input type="text" maxlength="1" class="code-digit" oninput="handleCodeInput(this, 1)">
                <input type="text" maxlength="1" class="code-digit" oninput="handleCodeInput(this, 2)">
                <input type="text" maxlength="1" class="code-digit" oninput="handleCodeInput(this, 3)">
                <input type="text" maxlength="1" class="code-digit" oninput="handleCodeInput(this, 4)">
                <input type="text" maxlength="1" class="code-digit" oninput="handleCodeInput(this, 5)">
            </div>
            <div id="verification-status" class="verification-status"></div>
            <button class="text-btn" onclick="resendCode()">Reenviar código</button>
        </div>
    </div>

    <!-- Pantalla Principal de Chat -->
    <div id="chat-list-screen" class="screen">
        <div class="chat-header">
            <h2>Chats</h2>
            <button class="add-contact-btn" onclick="showAddContact()">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        
        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Buscar conversaciones..." id="search-input">
        </div>

        <div class="chat-list">
            <div class="chat-item" onclick="openChat('John Smith', 'en', 'https://api.dicebear.com/7.x/avataaars/svg?seed=John')">
                <div class="avatar">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=John" alt="John">
                    <div class="status-indicator online"></div>
                </div>
                <div class="chat-info">
                    <div class="chat-name">John Smith</div>
                    <div class="last-message">Hello! How are you doing?</div>
                </div>
                <div class="chat-meta">
                    <div class="time">10:30</div>
                    <div class="unread-count">2</div>
                    <div class="language-indicator"></div>
                </div>
            </div>

            <div class="chat-item" onclick="openChat('María García', 'es', 'https://api.dicebear.com/7.x/avataaars/svg?seed=Maria')">
                <div class="avatar">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Maria" alt="María">
                    <div class="status-indicator online"></div>
                </div>
                <div class="chat-info">
                    <div class="chat-name">María García</div>
                    <div class="last-message">¡Hola! ¿Cómo estás?</div>
                </div>
                <div class="chat-meta">
                    <div class="time">09:45</div>
                    <div class="language-indicator"></div>
                </div>
            </div>

            <div class="chat-item" onclick="openChat('Pierre Dubois', 'fr', 'https://api.dicebear.com/7.x/avataaars/svg?seed=Pierre')">
                <div class="avatar">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Pierre" alt="Pierre">
                    <div class="status-indicator away"></div>
                </div>
                <div class="chat-info">
                    <div class="chat-name">Pierre Dubois</div>
                    <div class="last-message">Bonjour! Comment allez-vous?</div>
                </div>
                <div class="chat-meta">
                    <div class="time">Ayer</div>
                    <div class="language-indicator"></div>
                </div>
            </div>
        </div>

        <!-- Barra de navegación inferior -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showSection('chats')">
                <i class="fas fa-comments"></i>
                <span>Chats</span>
            </div>
            <div class="nav-item" onclick="showSection('translate')">
                <i class="fas fa-language"></i>
                <span>Traducir</span>
            </div>
            <div class="nav-item" onclick="showSection('calls')">
                <i class="fas fa-phone"></i>
                <span>Llamadas</span>
            </div>
            <div class="nav-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i>
                <span>Ajustes</span>
            </div>
        </div>
    </div>

    <!-- Pantalla de Chat Individual -->
    <div id="chat-screen" class="screen">
        <div class="chat-container">
            <div class="chat-header-individual">
                <button class="back-btn" onclick="goToChatList()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="contact-info">
                    <div class="avatar-small">
                        <img id="chat-avatar" src="" alt="">
                        <div class="status-indicator online"></div>
                    </div>
                    <div class="contact-details">
                        <div class="contact-name" id="chat-contact-name"></div>
                        <div class="contact-status">En línea</div>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="action-btn" onclick="startVideoCall()">
                        <i class="fas fa-video"></i>
                    </button>
                    <button class="action-btn" onclick="startVoiceCall()">
                        <i class="fas fa-phone"></i>
                    </button>
                    <button class="action-btn" onclick="showReportModal()">
                        <i class="fas fa-flag"></i>
                    </button>
                </div>
            </div>

            <div class="messages-container" id="messages-container">
                <div class="message received">
                    <div class="message-content">
                        <div class="original-text">Hello! How are you doing today?</div>
                        <div class="translated-text">¡Hola! ¿Cómo estás hoy?</div>
                    </div>
                    <div class="message-time">10:30</div>
                </div>
                
                <div class="message sent">
                    <div class="message-content">
                        <div class="original-text">¡Muy bien, gracias! ¿Y tú?</div>
                    </div>
                    <div class="message-time">10:32</div>
                </div>
                
                <div class="typing-indicator" id="typing-indicator" style="display: none;">
                    <div class="typing-avatar">
                        <img id="typing-avatar-img" src="" alt="">
                    </div>
                    <div class="typing-bubble">
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="message-input-container">
                <button class="attach-btn" onclick="selectImage()">
                    <i class="fas fa-image"></i>
                </button>
                <div class="input-wrapper">
                    <input type="text" id="message-input" placeholder="Escribe un mensaje..." onkeypress="handleEnterKey(event)" oninput="handleTyping()">
                    <button class="emoji-btn">
                        <i class="fas fa-smile"></i>
                    </button>
                </div>
                <button class="send-btn" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
                <input type="file" id="image-input" accept="image/*" style="display: none;" onchange="handleImageSelect(event)">
            </div>
        </div>
    </div>

    <!-- Pantalla para agregar contacto -->
    <div id="add-contact-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close-btn" onclick="hideAddContact()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3>Agregar contacto</h3>
            </div>
            <div class="modal-body">
                <input type="text" id="contact-name" placeholder="Nombre del contacto">
                <input type="tel" id="contact-phone" placeholder="Número de teléfono">
                <select id="contact-language">
                    <option value="es">Español</option>
                    <option value="en">English</option>
                    <option value="fr">Français</option>
                    <option value="de">Deutsch</option>
                </select>
            </div>
            <div class="modal-footer">
                <button class="secondary-btn" onclick="hideAddContact()">Cancelar</button>
                <button class="primary-btn" onclick="addContact()">Agregar</button>
            </div>
        </div>
    </div>

    <!-- Pantalla de Llamada de Voz -->
    <div id="voice-call-screen" class="screen">
        <div class="call-container">
            <div class="call-header">
                <button class="back-btn-call" onclick="endCall()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="call-status" id="call-status">Llamando...</div>
            </div>
            
            <div class="call-content">
                <div class="call-avatar">
                    <img id="call-avatar-img" src="" alt="">
                    <div class="call-animation">
                        <div class="pulse-ring"></div>
                        <div class="pulse-ring delay-1"></div>
                        <div class="pulse-ring delay-2"></div>
                    </div>
                </div>
                
                <div class="call-info">
                    <h2 id="call-contact-name"></h2>
                    <div class="call-duration" id="call-duration">00:00</div>
                </div>

                <div class="translation-info" id="translation-info">
                    <i class="fas fa-language"></i>
                    <span>Traducción automática activada</span>
                    <p>Habla en <strong id="user-lang">español</strong> y tu contacto escuchará en <strong id="contact-lang">inglés</strong></p>
                </div>

                <div class="speech-visualization">
                    <div class="speech-indicator" id="speech-indicator">
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                    </div>
                    <div class="speech-text" id="speech-text">Toca para hablar</div>
                </div>
            </div>

            <div class="call-controls">
                <button class="control-btn mute-btn" onclick="toggleMute()" id="mute-btn">
                    <i class="fas fa-microphone"></i>
                </button>
                <button class="control-btn speaker-btn" onclick="toggleSpeaker()" id="speaker-btn">
                    <i class="fas fa-volume-up"></i>
                </button>
                <button class="control-btn video-btn" onclick="switchToVideo()">
                    <i class="fas fa-video"></i>
                </button>
                <button class="control-btn end-call-btn" onclick="endCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Reporte -->
    <div id="report-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close-btn" onclick="hideReportModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3>Reportar usuario</h3>
            </div>
            <div class="modal-body">
                <div class="report-options">
                    <div class="report-option" onclick="selectReportOption(this, 'spam')">
                        <i class="fas fa-envelope"></i>
                        <div>
                            <h4>Spam</h4>
                            <p>Mensajes no deseados o repetitivos</p>
                        </div>
                    </div>
                    <div class="report-option" onclick="selectReportOption(this, 'harassment')">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <h4>Acoso</h4>
                            <p>Comportamiento abusivo o amenazante</p>
                        </div>
                    </div>
                    <div class="report-option" onclick="selectReportOption(this, 'inappropriate')">
                        <i class="fas fa-ban"></i>
                        <div>
                            <h4>Contenido inapropiado</h4>
                            <p>Contenido ofensivo o inadecuado</p>
                        </div>
                    </div>
                    <div class="report-option" onclick="selectReportOption(this, 'fake')">
                        <i class="fas fa-user-slash"></i>
                        <div>
                            <h4>Perfil falso</h4>
                            <p>Usuario que se hace pasar por otra persona</p>
                        </div>
                    </div>
                </div>
                
                <div class="evidence-section">
                    <h4>Evidencia (opcional)</h4>
                    <p>Puedes adjuntar hasta 3 fotos como evidencia</p>
                    <div class="evidence-upload">
                        <button class="upload-btn" onclick="selectEvidenceImages()">
                            <i class="fas fa-camera"></i>
                            <span>Adjuntar fotos</span>
                        </button>
                        <input type="file" id="evidence-input" accept="image/*" multiple style="display: none;" onchange="handleEvidenceSelect(event)">
                        <div id="evidence-preview" class="evidence-preview"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="secondary-btn" onclick="hideReportModal()">Cancelar</button>
                <button class="primary-btn" id="submit-report-btn" onclick="submitReport()" disabled>Enviar reporte</button>
            </div>
        </div>
    </div>

    <!-- Pantalla de Procesando Reporte -->
    <div id="report-processing-screen" class="screen">
        <div class="processing-container">
            <div class="processing-animation">
                <div class="spinner"></div>
            </div>
            <h2>Enviando tu reporte</h2>
            <p>Estamos procesando tu reporte...</p>
        </div>
    </div>

    <!-- Pantalla de Reporte Enviado -->
    <div id="report-success-screen" class="screen">
        <div class="success-container">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2>Reporte enviado</h2>
            <p>Tu reporte se verificará en aproximadamente 24 horas y será analizado por nuestro equipo.</p>
            <p>Gracias por tus comentarios.</p>
            <button class="primary-btn" onclick="goToChatFromReport()">
                <i class="fas fa-arrow-left"></i>
                <span>Volver al chat</span>
            </button>
        </div>
    </div>

    <!-- Pantalla de Historial de Llamadas -->
    <div id="calls-history-screen" class="screen">
        <div class="calls-header">
            <h2>Llamadas</h2>
            <button class="clear-history-btn" onclick="clearCallHistory()">
                <i class="fas fa-trash-alt"></i>
            </button>
        </div>
        
        <div class="calls-list" id="calls-list">
            <div class="empty-state">
                <i class="fas fa-phone-slash"></i>
                <h3>Sin historial de llamadas</h3>
                <p>Tus llamadas aparecerán aquí</p>
            </div>
        </div>

        <!-- Barra de navegación inferior -->
        <div class="bottom-nav">
            <div class="nav-item" onclick="showSection('chats')">
                <i class="fas fa-comments"></i>
                <span>Chats</span>
            </div>
            <div class="nav-item" onclick="showSection('translate')">
                <i class="fas fa-language"></i>
                <span>Traducir</span>
            </div>
            <div class="nav-item active" onclick="showSection('calls')">
                <i class="fas fa-phone"></i>
                <span>Llamadas</span>
            </div>
            <div class="nav-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i>
                <span>Ajustes</span>
            </div>
        </div>
    </div>

    <!-- Pantalla de Videollamada -->
    <div id="video-call-screen" class="screen">
        <div class="video-call-container">
            <div class="video-header">
                <button class="back-btn-call" onclick="endCall()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="call-status" id="video-call-status">Videollamada</div>
            </div>

            <div class="video-content">
                <video id="remote-video" class="remote-video" autoplay muted>
                    <!-- Simulación de video remoto -->
                </video>
                <div class="video-placeholder">
                    <img id="video-avatar" src="" alt="">
                    <div class="video-name" id="video-contact-name"></div>
                </div>
                
                <video id="local-video" class="local-video" autoplay muted></video>
                
                <div class="video-translation-info">
                    <i class="fas fa-language"></i>
                    <span>Traducción en tiempo real</span>
                </div>
                
                <div class="video-speech-text" id="video-speech-text"></div>
            </div>

            <div class="video-controls">
                <button class="control-btn video-mute-btn" onclick="toggleVideoMute()" id="video-mute-btn">
                    <i class="fas fa-microphone"></i>
                </button>
                <button class="control-btn camera-btn" onclick="toggleCamera()" id="camera-btn">
                    <i class="fas fa-video"></i>
                </button>
                <button class="control-btn switch-audio-btn" onclick="switchToAudio()">
                    <i class="fas fa-phone"></i>
                </button>
                <button class="control-btn end-video-call-btn" onclick="endCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
